<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Awesome ClojureScript!</title>

    <link rel="stylesheet" href="dist/reset.css">
    <link rel="stylesheet" href="dist/reveal.css">
    <!-- <link rel="stylesheet" href="dist/theme/black.css"> -->
    <link rel="stylesheet" href="dist/theme/white.css">

    <!-- Theme used for syntax highlighted code -->
    <link rel="stylesheet" href="plugin/highlight/monokai.css">
</head>

<body>
    <style>
        .columns2 {
            display:flex;
            align-items:center;
        }

        .columns {
            display:flex;
            align-items:center;
            justify-content: space-between;
        }

        .left-column {
            padding-right: 1rem;
        }
    </style>

    <div class="reveal">
        <div class="slides">
            <section data-markdown data-separator-notes="^Note:">
                <textarea data-template>
                    ### 2021 vs ClojureScript. Still alive?
                    Alex Bykbaiev
                </textarea>
            </section>
            <section data-markdown data-separator-notes="^Note:">
                <textarea data-template>
                    ### About

                    <img src="examples/assets/me.jpg" alt="me" width="250"/>

                    Alex Bykbaiev, Frontend Engineer at Hopin.

                    Note:
                    I'm working at Hopin, previously worked at Attendify (in July it was acquired by Hopin).
                </textarea>
            </section>
            <section data-markdown>
                <textarea data-template>
                    ### Agenda

                    - ClojureScript, what is it??
                    - Stuff I like in ClojureScript
                    - There is always a small fly in the ointment
                    - How and why we use ClojureScript in production
                    - Some resources to learn more about ClojureScript
                    - Q&A
                </textarea>
            </section>
            <section>
                <h3>ClojureScript, what is it??</h3>
                <div class="columns2">
                    <div class="left-column">
                        Clojure is a compiled, functional and dynamically typed language that targets multiple existing runtimes.
                        </br>
                        ClojureScript is a compiler for Clojure that targets JavaScript.
                    </div>
                    <img src="examples/assets/logo.png" alt="cljs logo" width="250" height="250"/>
                </div>
            </section>
            <section data-markdown>
                <textarea data-template>
                    ### Stuff I like in ClojureScript
                    <img src="examples/assets/fun-parts.jpeg" alt="advantages of ClojureScript" width="400">
                </textarea>
            </section>
            <section data-markdown data-separator-notes="^Note:">
                <textarea data-template>
                    ### Management of control flow
                    <img src="examples/assets/pure-fn.png" alt="control flow in FP" width="550">
                </textarea>
            </section>
            <section data-markdown data-separator-notes="^Note:">
                <textarea data-template>
                    ### REPL (Read–eval–print loop)
                    <img src="examples/assets/repl.gif" alt="REPL" width="700">
                </textarea>
            </section>
            <section>
                <section>
                    <h3>Collections</h3>
                    <div class="columns2">
                        <div class="left-column">
                            All collections in ClojureScript are persistent (immutability + structural sharing).
                        </div>
                        <img src="examples/assets/structural-sharing.png" alt="structural sharing" width="500">
                    </div>
                </section>
                <section>
                    <h3>List</h3>
                    <p>
                        List provides efficient access to the first elements
                        (linked list under the hood).
                    </p>
                    <pre>
                        <code class="language-clojure" data-trim data-noescape data-line-numbers="1,3,6-8">
                            (def list' '(1 2 3 4))

                            (list' 0)
                            => 1

                            (let [xs '(1 2 3)     ;; (1 2 3)
                                  ys (cons 0 xs)] ;; (0 1 2 3)
                              (identical? xs (rest ys)))
                            => true
                        </code>
                    </pre>
                </section>
                <section>
                    <h3>Vector</h3>
                    <p>
                        Vector provides efficient index access to its elements.
                    </p>
                    <pre>
                        <code class="language-clojure" data-trim data-noescape data-line-numbers="1,3">
                            (def vec' [1 2 3 4])
                        
                            (vec' 0)
                            => 1
                        </code>
                    </pre>
                </section>
                <section>
                    <h3>Map</h3>
                    <p>
                        Map is a collection abstraction that allow you to store key/value pairs.
                    </p>
                    <pre>
                        <code class="language-clojure" data-trim data-noescape data-line-numbers="1,3,6,9">
                            (def map' {:a 1 :b 2})

                            (get map' :a)
                            => 1

                            (map' :a)
                            => 1

                            (:a map')
                            => 1
                        </code>
                    </pre>
                </section>
                <section>
                    <h3>Set</h3>
                    <p>
                        Set stores zero or more unique items of any type and is unordered.
                    </p>
                    <pre>
                        <code class="language-clojure" data-trim data-noescape data-line-numbers="1,3,6">
                            (def set' #{1 2 3 10})
                        
                            (set' 0)
                            => nil

                            (set' 10)
                            => 10
                        </code>
                    </pre>
                </section>
            </section>
            <section>
                <section>
                    <h4>Metaprogramming</h4>
                    <p>
                        Clojure is also a dialect of LISP (LISt Processing language) by design.
                        The aim was to make the language more extensible.
                    </p>
                    <p>
                        Clojurescript allows you to write code that writes code (macros).
                    </p>
                </section>
                <section>
                    <h4>Macros</h4>
                    <pre>
                        <code class="language-clojure" data-trim data-noescape data-line-numbers="1-3,5,8">
                            (defmacro infix
                                [infixed]
                                (list (second infixed) (first infixed) (last infixed)))

                            (+ 1 1)
                            => 2

                            (infix (1 + 1))
                            => 2
                        </code>
                    </pre>
                    <aside class="notes">
                        For example, we are using macros for styled-components library.
                        Without it our React wrappers' template engine cannot understand and parse wrapped components
                        (to avoid direct calls to React.createElement).
                    </aside>
                </section>
                <section data-auto-animate>
                    <h4>Threading macros</h4>
                    <p data-id="code-title">Thread-first macro</p>
                    <pre data-id="code-animation">
                        <code class="language-clojure" data-trim data-noescape data-line-numbers="1-2|6-11|17-23">
                            (def user {:first-name "Alex"
                                       :last-name  "Bykbaiev"})
                            => {:first-name "Alex"
                                :last-name "Bykbaiev"}

                            (-> user
                                (update :full-name
                                        #(str (:first-name %)
                                                " "
                                                (:last-name %)))
                                (assoc :mental-age 54))
                            => {:first-name "Alex"
                                :last-name  "Bykbaiev"
                                :full-name  "Alex Bykbaiev"
                                :mental-age 54}

                            (assoc (update user
                                           :full-name
                                           #(str (:first-name %)
                                                 " "
                                                 (:last-name %))))
                                   :mental-age
                                   54)
                        </code>
                    </pre>
                </section>
                <section>
                    <h4>Threading macros</h4>
                    <p>Thread-last macro</p>
                    <pre>
                        <code class="language-clojure" data-trim data-noescape data-line-numbers="1,3,6-9">
                            (def numbers [1 2 3 4 5 6 7 8 9 0])

                            (take 2 (filter odd? (map inc numbers)))
                            => (3 5)

                            (->> numbers
                                 (map inc)
                                 (filter odd?)
                                 (take 2))
                            => (3 5)
                        </code>
                    </pre>
                </section>
                <section>
                    <h4>Threading macros</h4>
                    <p>Thread-as macro</p>
                    <pre>
                        <code class="language-clojure" data-trim data-noescape data-line-numbers="1,3,6-10">
                            (def points {:vals [1 2 3 4 5 6 7 8 9 0]})

                            (take 2 (filter odd? (map inc (get points :vals))))
                            => (3 5)

                            (as-> points $
                                  (get $ :vals)
                                  (map inc $)
                                  (filter odd? $)
                                  (take 2 $))
                            => (3 5)
                        </code>
                    </pre>
                </section>
                <section>
                    <h4>Threading macros</h4>
                    <p>Thread-some macros</p>
                    <pre>
                        <code class="language-clojure" data-trim data-noescape data-line-numbers="1,3-5,8-10">
                            (def user {:name "Alex"})

                            (-> user
                                (get :mental-age) ;; => nil
                                (str " years"))
                            => " years"

                            (some-> user
                                    (get :mental-age)
                                    (str " years"))
                            => nil
                        </code>
                    </pre>
                </section>
                <section>
                    <h4>Threading macros</h4>
                    <p>Thread-cond macros</p>
                    <pre>
                        <code class="language-clojure" data-trim data-noescape data-line-numbers="1,3,5,7-12">
                            (def month-of-birth "Jan")

                            (def motivating-Mars? true)

                            (def equalizing-Saturn? false)

                            (cond-> []
                                    (= month-of-birth "Jan") (conj "Capricornus")
                                    (= month-of-birth "Feb") (conj "Aquarius")
                                    ;; ...
                                    motivating-Mars? (conj "You would be unstoppable as the moon forms an energetic alignment to driven Mars")
                                    equalizing-Saturn? (conj "Strike a balance between visionary thinking and pragmatic planning"))
                            => ["Capricornus" "You would be unstoppable as the moon forms an energetic alignment to driven Mars"]
                        </code>
                    </pre>
                </section>
            </section>
            <section>
                <section>
                    <h4>Transducers</h4>
                    <div class="columns2">
                        <div class="left-column">
                            A transducer is a composable higher-order reducer. It takes a reducer as input, and returns another reducer.
                        </div>
                        <img src="/examples/assets/transducer.gif" alt="transducer">
                    </div>
                </section>
                <section data-auto-animate>
                    <pre data-id="code-animation">
                        <code class="language-clojure" data-trim data-noescape data-line-numbers="1,3-6|11-13,15,18,21">
                            (def xs [1 2 3 4 5 6 7 8 9 0])

                            (->> xs
                                 (map inc)
                                 (filter odd?)
                                 (take 2))
                            => (3 5)

                            ;; map = transform => reducer => reducer

                            (def tr (comp (map inc)
                                          (filter odd?)
                                          (take 2)))

                            (reduce (tr conj) [] xs)
                            => [3 5]

                            (into [] tr xs)
                            => [3 5]

                            (transduce tr conj [] xs)
                            => [3 5]
                        </code>
                    </pre>
                </section>
                <section>
                    <h4>Transducers</h4>
                    <img src="/examples/assets/transducer-from-the-box.png" alt="ClojureScript functions as transducers" width="800" />
                </section>
            </section>
            <section>
                <section>
                    <h4>Performance</h4>
                    <img src="examples/assets/compiler.png" alt="compilation flow" width="300">
                </section>
                <section>
                    <pre>
                        <code class="language-clojure" data-trim data-noescape data-line-numbers>
                            (def xs [1 2 3 4 5 6 7 8 9 0])

                            (->> xs
                                (map inc)
                                (filter odd?)
                                (take 2))
                        </code>
                    </pre>
                    <pre>
                        <code class="language-js" data-trim data-noescape data-line-numbers>
                            cljs.user.xs = new cljs.core.PersistentVector(
                                null, 10, 5, cljs.core.PersistentVector.EMPTY_NODE, [(1),(2),(3),(4),(5),(6),(7),(8),(9),(0)], null
                            );
                            cljs.core.take.call(
                                null,(2),cljs.core.filter.call(
                                    null,cljs.core.odd_QMARK_,cljs.core.map.call(
                                        null,cljs.core.inc,cljs.user.xs
                                    )
                                )
                            );
                        </code>
                    </pre>
                </section>
            </section>
            <section>
                <h4>Ecosystem</h4>
                <ul>
                    <li>Leiningen ~ npm (dependencies + scripts)</li>
                    <li>shadow-cljs ~ module bundler</li>
                    <li>Reagent/Om/Rum - React wrappers</li>
                    <li>Re-frame - Redux on steroids</li>
                </ul>
                <div class="columns">
                    <img src="examples/assets/leiningen.png" alt="Leiningen" width="200">
                    <img src="examples/assets/shadow-cljs.png" alt="shadow-cljs" width="200">
                    <img src="examples/assets/reagent.png" alt="reagent" width="200">
                    <img src="examples/assets/re-frame.png" alt="re-frame" width="200">
                </div>
            </section>
            <section>
                <h3>There is always a fly in the ointment</h3>
                <img src="examples/assets/fly-in-ointment.jpeg" alt="cons" width="600">
            </section>
            <section>
                <h4>Bundle size</h4>
                <img src="examples/assets/bundle-size.png" alt="bundle size" width="600">
                <a style="display:block;"
                   href="https://medium.com/dailyjs/a-realworld-comparison-of-front-end-frameworks-2020-4e50655fe4c1"
                   target="_blank">
                    RealWorld Comparison 2020
                </a>
                <aside class="notes">
                    RealWorld is an example of mid-size application to compare different frameworks/languages.
                    Here is a screen of RealWorld Clojure/Reagent applications' bundle size. 
                </aside>
            </section>
            <section>
                <h4>Performance</h4>
                <img src="examples/assets/performance.jpeg" alt="performance" width="500">
            </section>
            <section>
                <h4>Memory</h4>
                <img src="examples/assets/memory-leaks.png" alt="memory leaks" width="500">
            </section>
            <section>
                <h4>Dynamic type system</h4>
                <img src="examples/assets/dynamic-typing.jpeg" alt="dynamic type system" width="400">
            </section>
            <section>
                <h4>Support</h4>
                <img src="examples/assets/8-years.png" alt="8 years to fix performance issue" width="300">
                <a style="display:block" href="https://www.clojuriststogether.org/" target="_blank">clojurists together</a>
            </section>
            <section>
                <h4>No popular source of knowledge</h4>
                <p>JS - please, read the documentation, there are also learnjavascript, tonns of "Learn JS in 10 mins", video courses, books, blog posts etc.</p>
                <p>ClojureScript - hmm... we have Cheatsheet, maybe some API docs, 2-3 books (it's difficult to find, but you should try!)</p>
            </section>
            <section>
                <h4>Job opportunities</h4>
                <p>It's difficult both to find a job and to hire</p>
                <img src="examples/assets/difficult-choice.png" alt="how to get a CLJS job" width="320">
            </section>
            <section>
                <section>
                    <h4>How and why we use ClojureScript in production</h4>
                    <img src="examples/assets/attendify-slide.png" alt="Attendify app" width="800">
                    <aside class="notes">
                        I will talk about Attendifys' product (as I know it better). It's the platform for online conferences, webinars and other activities.
                        Stages with video broadcasting, recordings of previous sessions, chats, sponsors stands etc.
                        Server is written in Clojure, frontend in ClojureScript.
                    </aside>
                </section>
                <section>
                    <h4>We all write Clojure</h4>
                    <img src="examples/assets/full-stack.jpeg" width="500" alt="full-stack developer">
                    <aside class="notes">
                        We can reuse code, ask for help backend engineers, force them to write some frontend :D
                    </aside>
                </section>
                <section>
                    <h4>ClojureScript is an awesome tool to make things fast</h4>
                    <img src="examples/assets/fast.png" width="500" alt="fasten development">
                    <aside class="notes">
                        IMO, development with ClojureScript is faster than with plain old JS. Code is concise,
                        there are a lot of powerful tools (that you don't need to look for in some libraries or write by yourself).
                    </aside>
                </section>
                <section>
                    <h4>Performance</h4>
                    <img src="examples/assets/attendify-slide-2.png" alt="Attendify" width="700">
                    <aside class="notes">
                        One event can host about 10K attendees.
                        Watching of sessions, communication in chats, acquaintance with sponsors and other attendees.
                        It's difficult to support more attendees but not because of Clojure, I think it's more about
                        some design decisions that were made long time ago.
                    </aside>
                </section>
                <section>
                    <h4>Our stack</h4>
                    <p>Backend: Ring (HTTP requests), Compojure (routing), Aleph (framework), HugSQL (DB requests), prismatic/schema (declarative data description and validation), custom RPC protocol</p>
                    <p>Frontend: Reagent/Rum + re-frame</p>
                </section>
                <section>
                    <h4>How do we live in JS world?</h4>
                    <img src="examples/assets/webpack-module-federation.jpeg" alt="Webpack module federation plugin" width="400">
                    <aside class="notes">
                        How is ClojureScript functioning in large JS applications?
                        Now we are working on integration of ClojureScript application as micro-frontend.
                        The product is built as collection of micro-frontends for different features.
                        And our application with the help of Webpack Federation module would be the part of existing structure.
                        By the way we even can share some common dependencies between different applications (for example React).
                    </aside>
                </section>
            </section>
            <section>
                <h4>Some resources to learn more about ClojureScript</h4>
                <ul>
                    <li>ClojureScript Unraveled <a href="http://funcool.github.io/clojurescript-unraveled/#about-this-book" target="_blank">book</a></li>
                    <li>Clojure for the brave and true <a href="https://www.braveclojure.com/clojure-for-the-brave-and-true/" target="_blank">book</a></li>
                    <li>The joy of Clojure <a href="https://www.manning.com/books/the-joy-of-clojure-second-edition" target="_blank">book</a></li>
                    <li>Why I chose ClojureScript over JavaScript <a href="https://m.oursky.com/why-i-chose-clojure-over-javascript-24f045daab7e" target="_blank">post</a></li>
                </ul>
            </section>
            <section>
                <h4>Q&A</h4>
                <img src="examples/assets/q-and-a.jpeg" alt="Q&A" width="600">
            </section>
            <section>
                <h4>Thanks for attention!</h4>
            </section>
        </div>
    </div>

    <script src="dist/reveal.js"></script>
    <script src="plugin/notes/notes.js"></script>
    <script src="plugin/markdown/markdown.js"></script>
    <script src="plugin/highlight/highlight.js"></script>
    <script>
        // More info about initialization & config:
        // - https://revealjs.com/initialization/
        // - https://revealjs.com/config/
        Reveal.initialize({
            hash: true,

            // for PDF printing
            showNotes: 'separate-page',

            // Learn about plugins: https://revealjs.com/plugins/
            plugins: [RevealMarkdown, RevealHighlight, RevealNotes]
        });
    </script>
</body>

</html>